import React from "react";
import { Line } from "react-chartjs-2";
import { Chart, LineElement, CategoryScale, LinearScale, PointElement, Filler, Tooltip, Legend } from "chart.js";
import { getReservationLastMonth } from "../../features/dashboard/hooks/hooks_reservation";
Chart.register(LineElement, CategoryScale, LinearScale, PointElement, Filler, Tooltip, Legend);

const chartData = {
    labels: ["Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"],
    datasets: [
        {
            label: "Reservations",
            data: [65, 59, 80, 81, 56, 95, 40],
            fill: true,
            backgroundColor: "rgba(0, 103, 75, 0.1)",
            borderColor: "#00674B",
            tension: 0.4,
            pointBackgroundColor: "#00674B",
            pointBorderColor: "#fff",
            pointRadius: 4,
        },
    ],
};

const chartOptions = {
    responsive: true,
    maintainAspectRatio: false,
    scales: {
        y: {
            beginAtZero: true,
            grid: { drawBorder: false },
        },
        x: {
            grid: { display: false },
        },
    },
    plugins: { legend: { display: false } },
};

const ReservationsChart: React.FC<{ idRestaurant: string }> = ({ idRestaurant }) => {
    useEffect(() => {
        const result = await getReservationLastMonth(idRestaurant);
        if (result) {
            const labels = result.map(item => item.day);
            const data = result.map(item => item.reservations);
            chartData.labels = labels;
            chartData.datasets[0].data = data;
        } else {
            console.error("Failed to fetch reservation data for the last month");
        }
    }
        , [idRestaurant]);
    return (
        <div className="bg-white rounded-xl shadow-sm p-6">
            <div className="flex justify-between items-center mb-6">
                <h3 className="font-bold text-lg">Reservations Overview</h3>
                <select className="text-sm border rounded-lg px-3 py-2 bg-gray-50">
                    <option>Last 7 days</option>
                    <option>Last 30 days</option>
                    <option>Last 90 days</option>
                </select>
            </div>
            <div className="h-[300px]">
                <Line data={chartData} options={chartOptions} />
            </div>
        </div>
    );
}
export default ReservationsChart;
